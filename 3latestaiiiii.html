
<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8" />
  <title>AI Recipe Finder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 
  <style>
    :root {
      --bg-color:white;
      --text-color: #111;
      --card-bg: gold;
      --ingredient-bg:gold;
      /* --ingredient-bg: #43e69d; */
      --ingredient-color: #1b4332;
    }

    body.dark {
      --bg-color:black;
      --text-color: #eee;
      --card-bg: gold;
      --ingredient-bg: gold;
      --ingredient-color:  #1b4332;
    }

    body {
      font-family: Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      padding: 20px;
      margin: 0;
      transition: background 0.3s, color 0.3s;
    }

    h2 {
      margin-bottom: 10px;
    }

    input, button {
      padding: 12px;
      font-size: 16px;
      width: 100%;
      max-width: 500px;
      margin-bottom: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button {
      background-color:orange;
      color: white;
      cursor: pointer;
      transition: background-color 0.2s;
      border: none;
    }

    button:hover {
      background-color:orangered;
    }

    .toggle-container {
      margin-bottom: 20px;
    }

    #results {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .meal {
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      max-width: 400px;
      margin: 0 auto;
      height: 100%;
    }

    .meal img {
      width: 100%;
      height: auto;
      border-bottom: 1px solid #ddd;
    }

    .meal-content {
      padding: 15px;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .meal h3 {
      margin-top: 0;
      font-size: 20px;
      margin-bottom: 10px;
    }

    .ingredients-box {
      background-color:rgb(248, 235, 152);
      color: orangered;
      margin-top: 12px;
      padding: 10px;
      border-radius: 8px;
      flex-shrink: 0;
      cursor: pointer;
    }

    body.dark .ingredients-box {
      background-color:black;
    }

    .instructions-box {
      background-color: #f8f16d;
      margin-top: 12px;
      padding: 10px;
      border-radius: 8px;
      overflow-y: auto;
      flex-grow: 1;
      min-height: 100px;
      max-height: 250px;
      color: var(--text-color);
      cursor: pointer;
    }

    body.dark .instructions-box {
      background-color: #000000;
    }

    .ingredients span {
      display: inline-block;
      background-color: var(--ingredient-bg);
      color: var(--ingredient-color);
      padding: 5px 10px;
      margin: 4px;
      border-radius: 5px;
      font-size: 13px;
    }

    .tag {
      display: inline-block;
      padding: 4px 8px;
      font-size: 12px;
      border-radius: 4px;
      margin-bottom: 8px;
      background-color: #ffd54f;
      color: #000;
      font-weight: bold;
    }

    .tag.veg {
      background-color: #81c784;
      color: #1b5e20;
    }

    .tag.nonveg {
      background-color: #ef9a9a;
      color: #b71c1c;
    }

    .view-recipe-btn {
      margin-top: 10px;
      background: #28a745;
      padding: 8px;
      border: none;
      border-radius: 5px;
      color: #fff;
      font-size: 14px;
      text-decoration: none;
      text-align: center;
      display: inline-block;
      width: fit-content;
    }

    .toggle-ingredients-btn {
      background-color: #ff9800;
      color: #fff;
      margin-top: 10px;
    }

    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-thumb {
      background-color: #888;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background-color: #555;
    }

    @media (max-width: 600px) {
      input, button {
        font-size: 14px;
      }
    }
    .goback{
      text-decoration: none;
      background-color: orange;
      color: white;
      border: 2px solid orange;
      padding-left: 20px;
      padding-right: 20px;
     
      border-radius: 30px;
    }

    #theme-toggle{
      height: 24px;
      width: 24px;
      border-radius: 20%;
    }
  </style>
</head>
<body>
  <a href="#" class="goback" onclick="goBack()">Go Back</a>
  <button id="theme-toggle">
    <svg id="firstchild" class="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
      <path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Z"/>
    </svg>
    <svg id="secondchild" class="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960">
      <path d="M480-280q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280Z"/>
    </svg>
  </button><h2>Enter Ingredients (comma-separated):</h2>
  <input type="text" id="ingredientsInput" placeholder="e.g. chicken, garlic, onion">
  <button onclick="findMeals()">Find Meals</button>
  <div id="statusMessage"></div>
  <div id="results"></div>

  <script>
    document.getElementById("ingredientsInput").addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        e.preventDefault();
        findMeals();
      }
    });

    function goBack() {
      const from = localStorage.getItem("cameFrom") || "index.html";
      window.location.href = from;
    }
  </script>
  <script src="customRecipesTop500.js"></script>
<script>
 
  // ðŸ² Toggle Ingredient Box
  function toggleIngredients(id, btn) {
    const box = document.getElementById(id);
    const isVisible = box.style.display === "block";
    box.style.display = isVisible ? "none" : "block";
    btn.textContent = isVisible ? "Show Ingredients" : "Hide Ingredients";
  }

  // ðŸ½ï¸ Search Meals from API + Local
  async function findMeals() {
    const input = document.getElementById("ingredientsInput").value.trim();
    const ingredients = input.split(',').map(i => i.trim().toLowerCase()).filter(i => i);
    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "<p><i>Searching for delicious meals...</i></p>";

    // ðŸ” 1. LOCAL SEARCH
    const matchedLocalRecipes = customRecipes.filter(recipe =>
      ingredients.every(ing =>
        recipe.ingredients?.some(item => item.toLowerCase().includes(ing))
      )
    );

    // ðŸ” 2. API SEARCH
    let apiMealsDetails = [];
    try {
      const mealSets = await Promise.all(ingredients.map(async (ing) => {
        const res = await fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?i=${ing}`);
        const data = await res.json();
        return data.meals || [];
      }));

      const intersected = mealSets.reduce((acc, set, idx) => {
        const ids = set.map(meal => meal.idMeal);
        return idx === 0 ? ids : acc.filter(id => ids.includes(id));
      }, []);

      apiMealsDetails = await Promise.all(intersected.map(async (id) => {
        const res = await fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${id}`);
        const data = await res.json();
        return data.meals[0];
      }));
    } catch (err) {
      console.error("API fetch error:", err);
    }

    // âœ… COMBINE BOTH RESULTS
    const allMeals = [...matchedLocalRecipes, ...apiMealsDetails];
    if (allMeals.length === 0) {
      resultsDiv.innerHTML = "<p><i>No meals found with those ingredients.</i></p>";
      return;
    }

    resultsDiv.innerHTML = ""; // clear previous

    // ðŸ› Render Each Meal
    allMeals.forEach((meal, index) => {
      const mealDiv = document.createElement("div");
      mealDiv.className = "meal";

      const ingredientList = meal.ingredients && Array.isArray(meal.ingredients)
        ? meal.ingredients
        : Array.from({ length: 20 }, (_, i) => {
            const ing = meal[`strIngredient${i + 1}`];
            const measure = meal[`strMeasure${i + 1}`];
            return ing && ing.trim() !== "" ? `${measure} ${ing}`.trim() : null;
          }).filter(Boolean);

      const nonVegItems = ['chicken', 'beef', 'lamb', 'pork', 'fish', 'mutton', 'shrimp', 'crab', 'egg'];
      const isNonVeg = ingredientList.some(item =>
        nonVegItems.some(word => item.toLowerCase().includes(word))
      );
      const tag = isNonVeg
        ? '<span class="tag nonveg">Non-Veg</span>'
        : '<span class="tag veg">Veg</span>';

      const recipeLink = meal.strSource
        ? `<a href="${meal.strSource}" target="_blank" class="view-recipe-btn">See Full Recipe</a>`
        : "";

      const uniqueId = `ingredients-box-${index}`;

      mealDiv.innerHTML = `
        <img src="${meal.strMealThumb !== 'No image found' ? meal.strMealThumb : 'images/default.jpg'}" alt="${meal.strMeal}">
        <div class="meal-content">
          <h3>${meal.strMeal}</h3>
          ${tag}
          <button class="toggle-ingredients-btn" onclick="toggleIngredients('${uniqueId}', this)">Show Ingredients</button>
          <div class="ingredients-box" id="${uniqueId}" style="display: none;">
            <strong>Ingredients:</strong>
            <div class="ingredients">
              ${ingredientList.map(item => `<span>${item}</span>`).join('')}
            </div>
          </div>
          <div class="instructions-box">
            <strong>Instructions:</strong>
            <ul>
              ${(meal.strInstructions || "")
                .split(/[\.\n]+/)
                .map(step => step.trim())
                .filter(step => step.length > 0)
                .map(step => `<li>${step}.</li>`)
                .join('')}
            </ul>
          </div>
          ${recipeLink}
        </div>
      `;

      resultsDiv.appendChild(mealDiv);
    });
  }
  
</script>

  <script src="customRecipesTop500.js"></script>
  <script src="darkmode.js"></script>
  <script src="script.js"></script>
 
  

</body>
</html>  